(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{112:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return d}));var r=a(0),n=a.n(r);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=n.a.createContext({}),p=function(e){var t=n.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},b=function(e){var t=p(e.components);return n.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},m=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,c=e.originalType,o=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),b=p(a),m=r,d=b["".concat(o,".").concat(m)]||b[m]||u[m]||c;return a?n.a.createElement(d,s(s({ref:t},l),{},{components:a})):n.a.createElement(d,s({ref:t},l))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=a.length,o=new Array(c);o[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<c;l++)o[l]=a[l];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},210:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step3-c97df4a8b5efd70f058df5f7304067ce.png"},211:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step4-f2467b0f56b8002ac52b81049e97b7aa.png"},212:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step2-13b540ce6e9e69c2204ebbc4d151bf3b.png"},213:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step3-76b67412484f7b4f5b768190a92525a3.png"},214:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step31-9fb59ee1cda97d8b0bb343bc2b49089c.png"},215:function(e,t,a){"use strict";a.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB14AAAAtCAIAAACBPV7VAAAAA3NCSVQICAjb4U/gAAAZS0lEQVR4nO3df0wbZ5oH8O+WNJ7du8PWbmvo7mJYNTjslSbcmqQ0LBfCEQVySLGvkQAlkuGQ+HFVCURClIgUZYtKOUspEDUFJA4spYotZWVX4iBV9hx6FI4k+JakzpWF6NaY/WF7t3d2ur2ON0m5P4zBQEiAEAz29yP+sMfvzLzG7zvvzDMzz3xrZmYGAACr1apSqbCxQrJSIloh9tDww9+U1hdbFG0YNjaiNWP3IVozdh+iNWP32Sq+FRwaDm1ViIiIiIiIiIiIiGhjbAt+o9j5kw1eveNX/7nxKyWiFWIPDT/8TWl9sUXRhmFjI1ozdh+iNWP3IVozdp+t4plQV4CIiIiIiIiIiIiINhpDw0REREREREREREQRh6FhIiIiIiIiIiIioojD0DARERERERERERFRxGFomIiIiIiIiIiIiCjiMDRMREREREREREREFHEYGiYiIiIiIiIiIiKKOAwNExEREREREREREUUchoaJiIiIiIiIiIiIIs621c5w78/i3T/+7uuvvvzmmwfLlXnmmajv/JU0+nsvbHtW8mTVIyIiIiIiIiIiIqL1t7rQ8D3f13/47Z0f/uAHz8Y+v23bsvPev3//3r17v3FMPB+349nt337iShIRERERERERERHRelpFQol7fxb/+Ns7O158URCEqKiomeVFRUUJgrBjx4t/mL5z78++p1d7IiIiIiIiIiIiIlqDVVw17P3i97GxsQD+5Pum7d/vDv6370++bx5aMvfH36782+i/lDzzwgux//PF7773wo/Wp7JERKFjAwAkA5OAF0gNcXWIiIjCgRuwAVmhrgYREYW3ISAOUKx+xj4gCxAWTuTgReFkFVcN+776cvv27TMzM40f/++/3v7q7tf3v1nGv97+qmXAOzMzs337dvGrL59e7WmTsAF9wCgghromFN5C29Laytv1tT0A+t8yGItaQlEF2iCjgCVwMoDoaXAAfaGuA0Uy/3i66G8UAOBeOHHpllAERoE+wAI41qUyV8beeKl4PZZEtEn1Ae6HTVyXHkQUEqMPGyD6AO/TWZ24ZMx6RPexARbAsqTftWXVWS8MrHbVXlEseq5wesK5aPrklbG3OXiFqQjcaK/iquEHD+7780gMTH712MIDk1+dOiiNiop68OD+E1SPNqn8Lru+JEEARKDsgn30fEeiwz4tjZXk5Rua09ZwIo7oodquOPcpZanxwqZoaeInkMiAosoSAT7ZBq+cNoYX0L4/Pt3VEed2TioSUk+W6Y8mhLpSFIYqa83DXUb3Hy+GuiIUofS1PaaujxMXXgGlyn4ltadqtHekqKh1nwAAPmBSnhB3PN98MkUKALCJKG0YwRVjnNfpg2BTvqI5WaA7+IRjohPi5SdbAtGmZt5X3JmRb27OmZvSc92j+4eK4b5a7EoJYcWI1qyzqAWC0NleHjyx6LlCk6k2PWNFrXruQG8lhd0uT9FLFfuCyla2lCmOZi4qZvGgvmnEe+UjudvukwjTylfUrxfo8mT++YwtMYhZ0eoWEEX4jEADEBs8OX2PcLV7dspceITCQwRutFf3GDq/Bw8ePLaM9/8eX4a2KJMHV2tf7X/t1yqZMDzotFW9erU9TZ5xSJy4mVt4oFNhanw9B4AIWAEvkAgkhrrOtBUNAYaz1d7XtYjPufMELW0ISARE4A4QByQCXsAKRC9MCuG/J0gCJAPShbMDUAVNmYxX+xNKzKWY8LMAyYAcmAR8QNzCtQwBPmDfknuRaFNpuzDmbTpg6VZLd+139H6UXvyqZdfnWUqeCaD1ZLjl8V6qgM8FMDRMISJeU+0ZM7aWLZgoTQAAOCUwm4feAwCf6L7+8YGqFoPiatnRNAD1VT2qW9Xn2ougPASvZ7RLrylsVQ//Ml25eHB76Kjqvyd3GpgOjMjzNQIsC+/YXTTIEm1djc27D2gqTMd+qdklA+AGGquqdcfs0l0pACaB6WX2SxHYtyTafK5BBLAgNAyfEShDoPXGBV6olhwBBR/o+Vv+csdifnddTonPaLaen58UE7uojM0DbVZFqcxQ87McQbkbHtdob2tZUXNje3/j0SQAQ7uq5hJKOIKODYPzRfinP7QakwsHL7csyba3KWtheIQXyYWHCNxory40PDMzA+Cbbx6eYvihhSn8mFUa+FyW9EL5mRNqpSerPVN+9CIAIQaKbDs+MwI5bkBdOyLt1ctFjy1md+6ZosaDi7fdRI9mLaib/vSybcIZd2W8oCRhzS2tMbduR94h3+C41HHNhJ017VXDXQNxnxn7PTJ1c+3pg7EA+qZwutaQ/NnHIoQ7ew51tKhTZQCgfn/Mfb4jGaIuWysJ7B/oaw1ulzO1p0pf2+P1inNny994qfhcy4msgymGtww2tyhIY+NuGPs9sqyfnfC6RPmlDpvDoysp6z+ZtnH/RFolja9DcyZHerAbgKKkPO7sC+7rl6EsCHW9KHy4AV1Vte5kZsGbxlDXhSKaIE2CsmrZj+Nnhza5skr+Lz+GYwBIAzA92Kyua8DeKgCQIfVn5ValRi4Z8386xzAhvl1rSL31iSjAtudIZ4s6XQZRFIt+WFza0+TtMktdN03Yebq9qmDXbLhAED2nd1TcvdhUkJHgn1KqaSnNkCWfLFrnb0604eQZVaePGetrz2T1vycF6rtGVF6D5swvAdQPevobelRT16alseJxrfFkihzom0JNVU/qrU9EwLZrv66l6HB8qL8D0WoYansmvYAkIfGG0eaFr0RrOpkWHB0OPtBLba166KgRzOv1REul3vjySUBY5qyhrqlnH3pO912FMDskpe5tMigLJegA3gNQn1Wn/cdDRccz+6ZQWd6umvjEF79bdabonKbadvsDIUbWdt3T0dCTOnHTK2A6I9/QkjN3e03ndc9k+buSqV9Z43fr2ss1SsF2ZeyNqtbbt7uDwyNLL2SmrSgCN9qryDUMYGZmZmZm5sHK+As/pXpTCNWYDgHQDWnTjyYJu9TyoxfdQJ+It6+Lk4PO0rzdAEYvDCT3Hug3xetvH+koudZZnOtlHmJapUrDEYlULGs/VNSa+UQtzTfg/rCus1WmG9bmSjt0Gk3bsU8aLWX1x+3mhmIAIlBZWNGmbNVbDxmHXikVq2uqWgD0XXfaGg70t6PTeqQzQ2/9xVhgideAawAgXoP4yfyKxMuAPwvVTWtvc9tr/rWM68sLteKZxv78zu6d1gaNw8POsHkll3yQXNLtfz0pYtor7Ntq4zptcvVdI2rpyI682lBXhCKd2zebinHuLzhB5BAwBFiA+kERE2JBdoJ/ulop6D6c6pjC5GxBQX68H/EL4sJeoKagWKdo1d8+ZBzaX+Ctril/d/YznxEXKs51JzQOa8t2GfXvVM/PJsjU2XbDhwb/u0kPpgfPaPJ4YQGFiYIzHyROtDdeGBtywdJQoWupgpA0NCWaCg/0n7zZeTu/3xCvuHCgrWsEQGdtdWVMq956yGjdr1O03mmofuzyiTaZm8OXms/lGRuHtQbTTvc7ueZBe/DHwQd6jxo1Arxej08iyy0yn/5Jdf6+utz3x5cmNR7q7dAcL5qLCwMAhMTjJsXR92bfiZfhGwfQWFVXKTQbrYfM3cL0O8XwGf3Pshkq1pzb85Heesjc98qO64Wd581zCxI/rDN3C0br/kp5R+MJf5eczYYUHB55wv8abR6RttFeS0KJFV41TOErDQCEnLn7QkYvDeiqOtwY19SlyfPKARw+Kks/2D0aU+ADfK9lour7boddqkwIXZ1pK0oDBCAFmE3os+aWlpWdhJgCAIl71NNes3RvP4C4PWXudwoBDF+3+yZ6vJZf9wmxECA5GXv7cLFXrBruNaTviZVmfABAflStOv+jlVddpYR0bxMA+Z4T8B5OL7kIJMj3pgCn3I5xhSw8UxSFCwGAGyitMtTsERUZ6lDXh8LHkAu2dyraLO+5wSwlFGKTg2O6Fxc8P+ftntrUjCQAPh90L1UA8Imi2zuWdUqNXbM3T5xub0o+UaxPH9MpD0lfTlPlpZVmCKkL7xO2Xrdj0nh4+L8gJEGA5qRw7nCFW3wzGgCgLsmHTA0g7qdl7rMdwTMWHCs7V9zsFt+UC+jvHchSClJlDojCgyxF11qee6LC0ptfky0qDjYA6P+5QfEyRrO7IQBKyEumhi41o8Qk9470x2tVsoJU4HBrZuDKA6KtRKX0yA9+AEBQpqkyjEO9hoKMN4M+nz/QW27UkAcNLgp4tFJnWXaH/NR+762b6qpX64X+cyULTkzedYzJX54/9W4JenT54aBiXhF3BtuzTB9AVgAZtCWi+dOP/R8ZLVqHNHNISIAMQsY1962PgNkDgYKSI4ivApB7Utb4d4Vuz3tBi1wcHqFwEGEb7bUklFhJrmEwoUQkOZwtO2zZ7b0lahtGTkvtuuNJQ2JKZYNzx606BTwiRAA+kVdK0pNac0uTxO+efSWLkcQETudKZD6fF4DbMQIfzDvmTu551HD5XE63+2Z0zHwMV6pYRTxXkM+dNBYkEgmEBP9rAGBf2PRsIkrLzQWu6sqLJu7k0XoRgZoT7+peTxDiczBlD3V1KNKp9gjG1t0LJilmN3cSCcx9O/2vxQnUNFzWeo6Yf5YJADE5GsMvNVNm742PbYMdhipRIy0yXGxKD7rBwu0YkStiIMyOg3JlGuD1OuzRilgAwtzAKsjg8wSvP/GgWiWtMPWOlB1NM/3cWHOMyXworCTmNWm6fmz5tK7M2j97HnrimvuGx7yjMFDEnip1AtCdyq8vb9ZecQkZh7KOptVnJCxNvUq0yQUfOkljktxTN5crudyoIQ+63Cc5Lyc57z/8FwxJlShzFOrer0PJ1eDlSODz+ub3299+sRA++IA7wKStWzr7LDp4XU74vHLFbFg5blcOcMr/unQwx9plULl+JRXgcI0p9sxXQK6cLS+NTwF8bvfWi/3RakXURpuhYXoiDgCAQpYCWYpUiQJXhe5sBY5fbax6N9fV0WhqQEyC1yMa4/RBJ+2IVu2JW9qjonvRECVyofN2flCpMkAmgegLmuR7XIjQ51v5F6LNa8iD0sKWxphWjakfAq/vpnXTecUudXSg5z+GALcPAIZEJApb8lEVFAYel2t49iMhHgVo1xQWiqd+LwgQAQGxiC+XxpenHxXTxYG7WcX6szHprfOLioYoBo2Y/teSFe0HyvJfU+sv6XOz06YHzVnt/Wv8bkSblBCXURbtMiIm0/9eCjE5O6HTkB9cBoA0o+qcNUkc1Ft7i3WF0P5j9+y5GaJNQxo4QJvjFgFAKpl9GzwQeCFIBA+WsbJRQzZ3IykAifKI6F58z36yQmqZsGsCb6/27wbgdrmSD7f6fO8BsxmKBIgARGF2jXcDN3INTXj6y1+19qTJs/MhyGpqPe6p+Tr4AsX81YuG6F7u+1D4iKCN9lpyDX+zMsw1HK4kQfGxzrfMZScMc28nhVeiYQfgvqFPPlaLmCIg0/QZc+7Qk3qqLS1ZEXvXLY56cwA1oJ4U1SaXGhCS5TKba3YnRgRGJxafHJYImIsGO0Tc9S67x0NbhUNEaWHdOaVe03OVcWFaX94Pz0gcgk51RvdSRaemDoBOVTHZOxLqehE9xjSSJD6XAM/klCe5yGybP1IWIOR4lTlS77Xg8smK2D84nJOBIXF4wvm8BArFipKoaI5r7/zCrPv5QG6GTIjhRpjC3L6XZaMTEKH274JaXOpRMQdAjwuikCMcvJje+nlNe4H1fPFjF0W0wfbtibXesAdHhzt+Mfa8BMmBS31tjvkjo8kpZ3LMsqPASkaNtl57ftfcc1/QP+FJViy+aqf0tRzz+3qLK/Be+SaUb9oUtQAkkvli8hiZBLBNza7PcsvufzF9/XJ0jCjPuwhBLSLTcmvBwkcds0eCtimPBFDI56sneczlQxQ+wnijvbrQsN9KnkH3nWfXvaq0WUghAOicEEdFlGbYHR/WaS85e1yovy52vm+sPJgEQKVAx6din4i2Cdzuao6WwOTC0lTxRI8ml8AwIVo8q25ptinxpRMD7pWFahV7M/NfFiprDSYPTB5oqwzW8mIAmrz97hsDNVc8JhFlF+xyx+IITpYyfuiWs8+DIaDx/MDzEl42vOU1nr8sdfU4Tvb3TCX0TKFnCkMM+NM6Od2Sbx46Ye7bbe7b3dGeAMDctzM9m0mHKTQmveiYWvw3x78B7JhCzSDqG4w12fEQZIkxnqxbhfmFLfXX0eNCxxTUXfbJ3oHSowsSUyj2puW/LFQ2mU0iDC68/Y6+Jm83hBU9UE6qzMndJRgbqguOadf3+xJtQrl5R+TuEW3XeJ+Ijim8UVh9t6sdgDkrt+D9MZMHJo+gu/5KrpL7IrTpaI5qVeI1TZGh/jraJqC95NGfqNaV7IcswV9A6hgpvWDvE1E/6Jm+MaLO279oCXMHeisZNXJhttZqSns9PS68ccVjOdtx+p8WJ6PXnGoojRnX5lZoL3naJvD2LeRfcJYWNtfvkUqFoPCtIFPviW88f9nkQccUhrpms96r4oW7LrFtQuwToX1/bJ93wOYWRwMzmbuMPS6YPGg8a9b+NB6y+eoFh0covIXxRnsVCSWeiYq6f/9+VFRUpvIv/u3zu48unKmMnpmZuX///jNRa3nSHW1mcmXCP/9UOnw4N7muLPX18v6Wj/Vn/2a4KkkqdRrykH7GBEB3pqyt/Iz5pWv7lE5da9k+YcBSXuG92C3dyyuIaRV0x1L0TdWTNz7J6mlaVUuLFsT0D7Mkp34HxO6TQBFY4A4AgZPGUkA9+1o4d7HbVFthSf8IQM3LI5r2bgDyvWrzqVZ91asWJJVmO6dfm93/UAH+G4iyjqkbrzT3pxdKFbH1xzydyp3REAEkA3OPTZBLkBu0K6KWYMslHooocVea4cBw+lwCKQjH8tFcHsIqUfiQ5cw9fE6AXS1pnrtnn2iDqQR4bwxY019dOFnAb67KgVz4htMP+CdJpXZ9NtLPdAOAkNBp6rY0VVvKO4bdsRKJqFaOH+7Jkectasmycxc/MFRVWF7SC4J4LmM8610TAEGAWoLoQKE4IEsCAHIgK2igzDqmtta2pueZnsL3JgqxHZIFrV2IzzRfLDc0HDC/kykVnPo8Z+rrJwDou/cbGnItZ9MAqHeNFPQ0harCRMuKSTH2nze9VTFceMbmk+1QjNefTEp8fX7TnfzTNO1nxYamWAFj5lMJiozF6eODDvTee+ioESwxr9zS/LH+rR8Pu5Pi5Pb+uoTE40v6hZB0us+kOVttOvsjmyNJIhGzlHZdSYri2FUIMgBZAhIlAKBrb+gsr+5XfaJSehpPHkr/1CiRCIkZmfpjsabcA9PShNPHPXHtTY2aamvRu8kt5WoJ6o/BXJg7PCVolQPa9g8QNHgFh0fwetF6/pMp1CJno/2tuZwPVqtVsfMnjyj6xe9+/Zff2S4Iwl3xwZs/n77+6z99KT486bDmb7576u+/Hy1Eff3113/6+t5z3//Rcst0/Oo/H71S2qzswDiQEkjZMwbYAVngSaMITHQCSUAC4ATGgEw+0Glr2QQ91AOMALGB3FIrb2kiMAD4HxQ7ACQACQCAccAz+xhZeICBucfOBuYFkIa5+A1EYCQwcRwAkLJwIf65/FUaAJKA2EeuxQxkBi1/o22C33STGwAWneZNCE5tRouwRa2VCFwO2jLQ47GxrSv/eLqUGnAGBj6/RWMuADEw8gqBwfeh/OOjsHD24EHQXyAn6AUA5Ne2p3uNle1XH7ZMWiN2n01jHHACmUsm2pd0FnvQnueKLrqnp4Td55E8wBjgWbTDXF9b7XY5O3u6gYElbTt43uADvYeOGov4Rx9Z4DhrOf5iWDJIDfiPCocAqTieLNiBJMstsTT9r+98+X+AEKiSEOikA4Ecx2YgB7AD9qBlBg9e9oXhEZq19btPpGy0VxEavvdn0T098cMf/GDlS//Nb38bo9i57VnJcgW2fkMhCmfsoeGHvymtL7Yo2jBsbGHPIqJ/0GMpftViaZIqeeJkPbH7EK0Zu88aBELDF0NdkYd7u+hds1f2Rnu5ALSdaMn1dZw2fR7qSoUndp+tYhXZHp7dLsh/uOM303eee+5727Zti4qKWq7kgwcP7t2798UX/yOPS3xEXJiIiIiIiAiArbAaE5dNLSmMCxMRbWlz+fc2p9PNKYknCof2GQGhZs+YP5cgUSRbXSLgZyXfiYnfefeL33/91RcP7t9frljUtm3f/ovo2ISkqG3bn7iGREREREQU5ipN+cCRJbdtEhHRFqNpLluSom0zickpMHxeMJtLcEve/k+0vlb9jLhtz0q+G5vwFGpCREREREQR69G5I4mIaKvY/A+fj53LcU9Ez4S6AkRERERERERERES00RgaJiIiIiIiIiIiIoo4DA0TERERERERERERRRyGhomIiIiIiIiIiIgiDkPDRERERERERERERBGHoWEiIiIiIiIiIiKiiMPQMBEREREREREREVHEYWiYiIiIiIiIiIiIKOIwNExEREREREREREQUcRgaJiIiIiIiIiIiIoo435qZmfG/slqtoa0KEREREREREREREW2MbcFvVCrVBq/earVu/EqJaIXYQ8MPf1NaX2xRtGHY2IjWjN2HaM3YfYjWjN1nq2BCCSIiIiIiIiIiIqKI8/8fZMP+yBjKZwAAAABJRU5ErkJggg=="},216:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step331-c49fd332e9743dfd5191415b2b57c58d.png"},217:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step332-d3aa50e34f007116e383920ddcea0e67.png"},218:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step34-12e72d39dd807afa4490c0e2fe4969a5.png"},219:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step35-abc8bb86932fd1525a6c1669faa7c48e.png"},220:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step36-797437775d4e7e0a2e40804a3850b706.png"},221:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step37-1606d5cab7736d58e091866dd6faca02.png"},222:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step2-11be7b3ed319ec64f1cc378a0a8ab7aa.png"},223:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step3-344bf373bce74426c765c689ebeae2af.png"},224:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step4-ace7298db6ed992a6f3cf6a0156324a9.png"},225:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step5-27d969f1d6510fa02666a11bb71d292a.png"},226:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step2-4830d407812bda8498254ca1d1a09c22.png"},227:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step4-f870bba8b8e77ba9ad679867977a815f.png"},228:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step5-68c6e3f8b123c63eec5b53378720b6a8.png"},229:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step6-a7c9d41f96aad218dd87bda3de5a9fe9.png"},230:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step8-3df912fd42e9fb5d97c88d0293673bc4.png"},231:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step9-568ecd4b63aed933a652390869c31fbd.png"},232:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step2-aa25554e38dd00c43873bc57e20505e2.png"},233:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step4-42b0b5c383fa24ed0e510156cd202ee9.png"},234:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step5-4476bfc83f0334b2c8137ab751ef5968.png"},235:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step6-76241e3306e7c6c85756776cc70b7a7e.png"},236:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step8-5b28af512a94dcbe487bfc76d87a4a4b.png"},237:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step10-f1928edea873861e6c3a6a92ac1ac250.png"},238:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step4-ec27b824df8d6b284d48aecdbbcc4a35.png"},239:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step6-a29e097602ebd2a7bb662244c189929e.png"},240:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/step5-acd77e6a1065122e7242897318768f3a.png"},79:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return i})),a.d(t,"default",(function(){return p}));var r=a(2),n=a(6),c=(a(0),a(112)),o={title:"Flavor A Manual Setup (AWS)",sidebar_label:"Manual Setup (AWS)"},s={unversionedId:"flavors/flavor-a/manual-setup-aws",id:"flavors/flavor-a/manual-setup-aws",isDocsHomePage:!1,title:"Flavor A Manual Setup (AWS)",description:"Requirements",source:"@site/docs/flavors/flavor-a/manual-setup-aws.md",slug:"/flavors/flavor-a/manual-setup-aws",permalink:"/k8-proxy-documentation/docs/flavors/flavor-a/manual-setup-aws",version:"current",sidebar_label:"Manual Setup (AWS)",sidebar:"someSidebar",previous:{title:"Flavor A FAQ",permalink:"/k8-proxy-documentation/docs/flavors/flavor-a/faq"},next:{title:"Flavor A Automated Setup",permalink:"/k8-proxy-documentation/docs/flavors/flavor-a/automated-setup"}},i=[{value:"Requirements",id:"requirements",children:[{value:"Client Machine tools",id:"client-machine-tools",children:[]},{value:"AWS requirements",id:"aws-requirements",children:[]}]},{value:"Setting up AWS Resource Group",id:"setting-up-aws-resource-group",children:[]},{value:"Setting up AWS EC2 instance for Rancher for Flavour A",id:"setting-up-aws-ec2-instance-for-rancher-for-flavour-a",children:[]},{value:"Associate Elastic IP to Rancher Instance",id:"associate-elastic-ip-to-rancher-instance",children:[]},{value:"Setting up Route 53 for Rancher Instance",id:"setting-up-route-53-for-rancher-instance",children:[]},{value:"IAM user for Rancher",id:"iam-user-for-rancher",children:[]},{value:"Setting up Rancher",id:"setting-up-rancher",children:[{value:"Before following the Rancher Docs",id:"before-following-the-rancher-docs",children:[]}]},{value:"Creating an IAM user for Docker Repository",id:"creating-an-iam-user-for-docker-repository",children:[]},{value:"Setting up Repository for Docker in AWS",id:"setting-up-repository-for-docker-in-aws",children:[]}],l={rightToc:i};function p(e){var t=e.components,o=Object(n.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},l,o,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h2",{id:"requirements"},"Requirements"),Object(c.b)("h3",{id:"client-machine-tools"},"Client Machine tools"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("strong",{parentName:"li"},"kubectl")," ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"}),"https://kubernetes.io/docs/tasks/tools/install-kubectl/")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("strong",{parentName:"li"},"aws cli"),"  ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html"}),"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("strong",{parentName:"li"},"docker"),"  ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://docs.docker.com/engine/"}),"https://docs.docker.com/engine/")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("strong",{parentName:"li"},"helm")," ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://helm.sh/docs/intro/install/"}),"https://helm.sh/docs/intro/install/"))),Object(c.b)("h3",{id:"aws-requirements"},"AWS requirements"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"An IAM user with ",Object(c.b)("strong",{parentName:"li"},"SystemAdministrator")," policy attached. If yuo don't have permission to change Policies or create ECR repository contact the administrator.")),Object(c.b)("h2",{id:"setting-up-aws-resource-group"},"Setting up AWS Resource Group"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"Open the Resource Group console at ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://console.aws.amazon.com/resource-groups"}),"https://console.aws.amazon.com/resource-groups")),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Create Resource Group"),", select Tag Based."),Object(c.b)("li",{parentName:"ol"},"Add two tags with:\n",Object(c.b)("img",{alt:"step3",src:a(210).default}),Object(c.b)("ol",{parentName:"li"},Object(c.b)("li",{parentName:"ol"},"Key rg-gw-dev and name rancher"),Object(c.b)("li",{parentName:"ol"},"Key rg-gw-dev and name k8s-node"),Object(c.b)("li",{parentName:"ol"},"Key rg-gw-dev and name rancher-user"),Object(c.b)("li",{parentName:"ol"},"Key rg-gw-dev and name ecr-user"))),Object(c.b)("li",{parentName:"ol"},"These will be used later when creating EC2 instances for rancher and k8s\n",Object(c.b)("img",{alt:"step4",src:a(211).default})),Object(c.b)("li",{parentName:"ol"},"Add group name then choose ",Object(c.b)("strong",{parentName:"li"},"Create Group"))),Object(c.b)("h2",{id:"setting-up-aws-ec2-instance-for-rancher-for-flavour-a"},"Setting up AWS EC2 instance for Rancher for Flavour A"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"Open the EC2 console at ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://console.aws.amazon.com/ec2/"}),"https://console.aws.amazon.com/ec2/")),Object(c.b)("li",{parentName:"ol"},"Click on instances\n",Object(c.b)("img",{alt:"step2",src:a(212).default})),Object(c.b)("li",{parentName:"ol"},"Launch instances\n",Object(c.b)("img",{alt:"step3",src:a(213).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 1: Choose an Amazon Machine Image (AMI)"),", Select ",Object(c.b)("strong",{parentName:"li"},"Ubuntu Server 20.04 LTS (HVM), SSD Volume Type"),".\n",Object(c.b)("img",{alt:"step31",src:a(214).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 2: Choose an Instance Type"),", For Flavour A, We went with t3a.medium because of the minimum requirement for Rancher  choose ",Object(c.b)("strong",{parentName:"li"},"Next: Configure Instance Details"),".\n",Object(c.b)("img",{alt:"step32",src:a(215).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 3: Choose an Instance Type"),", Leave everything to default and choose ",Object(c.b)("strong",{parentName:"li"},"Next: Add Storage"),".\n",Object(c.b)("img",{alt:"step331",src:a(216).default}),Object(c.b)("img",{alt:"step332",src:a(217).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 4: Add Storage"),", change size to 30GB then choose ",Object(c.b)("strong",{parentName:"li"},"Next: Add Tags"),Object(c.b)("img",{alt:"step34",src:a(218).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 5: Add Tags"),", add a tag with key rg-gw-dev and name rancher i.e the tag we added in our Resource Group. The tag should match the one you created in Resource Group since we are using Resource Group based on tags. Choose ",Object(c.b)("strong",{parentName:"li"},"Next: Configure Security Group"),Object(c.b)("img",{alt:"step35",src:a(219).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 6: Configure Security Group"),", select Create a new security group if not previously created. Give the name and description for the security group. Leave everything to default and choose ",Object(c.b)("strong",{parentName:"li"},"Next: Review Instance Launch"),Object(c.b)("img",{alt:"step36",src:a(220).default})),Object(c.b)("li",{parentName:"ol"},"In ",Object(c.b)("strong",{parentName:"li"},"Step 7: Review Instance Launch"),", review everything and ",Object(c.b)("strong",{parentName:"li"},"Click on Launch")),Object(c.b)("li",{parentName:"ol"},"Download the key pair to ssh into the server later. If you don\u2019t download the keypair now you won\u2019t be able to in the future\n",Object(c.b)("img",{alt:"step37",src:a(221).default})),Object(c.b)("li",{parentName:"ol"},"Launch instances")),Object(c.b)("h2",{id:"associate-elastic-ip-to-rancher-instance"},"Associate Elastic IP to Rancher Instance"),Object(c.b)("p",null,"The public ip AWS assings isn't persistent and will change everytime you shutdown the instace.So, you'll need to set-up an Elastic IP."),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"Open the EC2 console at ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"http://console.aws.amazon.com/ec2"}),"http://console.aws.amazon.com/ec2")),Object(c.b)("li",{parentName:"ol"},"Select ",Object(c.b)("strong",{parentName:"li"},"Elastic IP")," and click on ",Object(c.b)("strong",{parentName:"li"},"Allocate Elastic IP address"),Object(c.b)("img",{alt:"step2",src:a(222).default})),Object(c.b)("li",{parentName:"ol"},"Choose ",Object(c.b)("strong",{parentName:"li"},"Allocate"),Object(c.b)("img",{alt:"step3",src:a(223).default})),Object(c.b)("li",{parentName:"ol"},"Select the newly created Elastic IP, choose actions then choose ",Object(c.b)("strong",{parentName:"li"},"Associate IP address"),Object(c.b)("img",{alt:"step4",src:a(224).default})),Object(c.b)("li",{parentName:"ol"},"Select the Rancher instance and select the private ip that has been associated with the rancher instance.Choose ",Object(c.b)("strong",{parentName:"li"},"Associate"),Object(c.b)("img",{alt:"step5",src:a(225).default}))),Object(c.b)("h2",{id:"setting-up-route-53-for-rancher-instance"},"Setting up Route 53 for Rancher Instance"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"The following steps are done using the old console. Switch to the old console before proceeding.")),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"Open the Route 53 Console ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://console.aws.amazon.com/route53"}),"https://console.aws.amazon.com/route53")),Object(c.b)("li",{parentName:"ol"},"Select ",Object(c.b)("strong",{parentName:"li"},"Hosted Zone"),Object(c.b)("img",{alt:"step2",src:a(226).default})),Object(c.b)("li",{parentName:"ol"},"Click on ",Object(c.b)("strong",{parentName:"li"},"Create Hosted Zone")," and enter your domain name you want to use for the AWS instances"),Object(c.b)("li",{parentName:"ol"},"Copy the NS value and follow the process of your registrar for the domain to change the name servers of your domain to user the four Route 54 name server that you got after step 3.\n",Object(c.b)("img",{alt:"step4",src:a(227).default})),Object(c.b)("li",{parentName:"ol"},"Then we need to create an A record for the Rancher instance. Click on ",Object(c.b)("strong",{parentName:"li"},"Create Record Set"),Object(c.b)("img",{alt:"step5",src:a(228).default})),Object(c.b)("li",{parentName:"ol"},"Add a subdomain or leave it blank. Select ",Object(c.b)("strong",{parentName:"li"},"Type: A - IPv4 address")," if not previously selected and type in the Elastic IP retrieved from ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/my-stolen-username/flavour-A-aws-setup#associate-elastic-ip-to-rancher-instance"}),"https://github.com/my-stolen-username/flavour-A-aws-setup#associate-elastic-ip-to-rancher-instance"),"  in ",Object(c.b)("strong",{parentName:"li"},"value"),".\n",Object(c.b)("img",{alt:"step6",src:a(229).default})),Object(c.b)("li",{parentName:"ol"},"Click on ",Object(c.b)("strong",{parentName:"li"},"Create")),Object(c.b)("li",{parentName:"ol"},"Select the newly created a record and Click on ",Object(c.b)("strong",{parentName:"li"},"Test Record Set")," to check if the record is working or not.\n",Object(c.b)("img",{alt:"step8",src:a(230).default})),Object(c.b)("li",{parentName:"ol"},"Click on ",Object(c.b)("strong",{parentName:"li"},"Get Response"),". You'll see ",Object(c.b)("strong",{parentName:"li"},"DNS response code:  NOERROR")," if it's working.\n",Object(c.b)("img",{alt:"step9",src:a(231).default}))),Object(c.b)("h2",{id:"iam-user-for-rancher"},"IAM user for Rancher"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"Open the IAM user console ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"http://console.aws.amazon.com/iam"}),"http://console.aws.amazon.com/iam")),Object(c.b)("li",{parentName:"ol"},"Click on Users\n",Object(c.b)("img",{alt:"step2",src:a(232).default})),Object(c.b)("li",{parentName:"ol"},"Click on ",Object(c.b)("strong",{parentName:"li"},"Add User")),Object(c.b)("li",{parentName:"ol"},"Give name to the group and select ",Object(c.b)("strong",{parentName:"li"},"Programmatic access"),", choose ",Object(c.b)("strong",{parentName:"li"},"Next: Permissions"),Object(c.b)("img",{alt:"step4",src:a(233).default})),Object(c.b)("li",{parentName:"ol"},"Click on Create Group\n",Object(c.b)("img",{alt:"step5",src:a(234).default})),Object(c.b)("li",{parentName:"ol"},"Type in the name of the group and search for ",Object(c.b)("strong",{parentName:"li"},"AmazonEC2FullAccess")," and select it then click on ",Object(c.b)("strong",{parentName:"li"},"Create group"),Object(c.b)("img",{alt:"step6",src:a(235).default})),Object(c.b)("li",{parentName:"ol"},"Select the newly created group, choose ",Object(c.b)("strong",{parentName:"li"},"Next: Tags")),Object(c.b)("li",{parentName:"ol"},"Add tags for the user i.e key rg-gw-dev name rancher-user, choose ",Object(c.b)("strong",{parentName:"li"},"Next: Review"),Object(c.b)("img",{alt:"step8",src:a(236).default})),Object(c.b)("li",{parentName:"ol"},"Review then choose ",Object(c.b)("strong",{parentName:"li"},"Create User")),Object(c.b)("li",{parentName:"ol"},"Download the CSV or save the Access key ID and Secret access key which will be used later for rancher\n",Object(c.b)("img",{alt:"step10",src:a(237).default})),Object(c.b)("li",{parentName:"ol"},"Close")),Object(c.b)("h2",{id:"setting-up-rancher"},"Setting up Rancher"),Object(c.b)("h3",{id:"before-following-the-rancher-docs"},"Before following the Rancher Docs"),Object(c.b)("p",null,"It is highly advised to have a domain for the Rancher instance or you'll be facing tons of issues.\nUse the ",Object(c.b)("strong",{parentName:"p"},"Access key id")," and ",Object(c.b)("strong",{parentName:"p"},"Secret access Key")," that was retrieved in ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/my-stolen-username/flavour-A-aws-setup#iam-user-for-rancher"}),"https://github.com/my-stolen-username/flavour-A-aws-setup#iam-user-for-rancher")," when Rancher asks for it.\nAfter you have everything required follow the steps below:"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"SSH to Rancher instance using the keypair that you retrieved from ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-aws-ec2-instance-for-rancher-for-flavour-a"}),"https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-aws-ec2-instance-for-rancher-for-flavour-a"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install docker"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"sudo apt-get update\nsudo apt-get install apt-transport-https  ca-certificates  curl  gnupg-agent software-properties-common\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo apt-key fingerprint 0EBFCD88\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Deploy rancher server using docker"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," docker run -d --restart=unless-stopped \\\n -p 8080:80 -p 8443:443 \\\n --privileged \\\n rancher/rancher:latest \\\n --no-cacerts\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install Apache2 and enable proxy and rewrite"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," sudo apt-get install apache2\n sudo a2enmod proxy proxy_http proxy_wstunnel proxy_balancer proxy_connect headers\n sudo a2enmod rewrite \n sudo systemctl restart apache2\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Edit the vhost conf file. Replace the  your-rancher-domain with domain configure in ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-route-53-for-rancher-instance"}),"https://github.com/my-stolen-username/flavour-A-aws-setup#setting-up-route-53-for-rancher-instance")," "),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"sudo vi /etc/apache2/sites-available/000-default.conf\n")),Object(c.b)("p",{parentName:"li"},"Change it to "),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),'<VirtualHost *:80>\n ServerName <your-rancher-domain>\n ProxyRequests Off\n ProxyPreserveHost On\n RewriteEngine On\n RewriteCond %{HTTP:Connection} Upgrade [NC]\n RewriteCond %{HTTP:Upgrade} websocket [NC]\n RewriteRule /(.*) ws://0.0.0.0:8080/$1 [P,L]\n RequestHeader set X-Forwarded-Proto "https"\n RequestHeader set X-Forwarded-Port "443"\n <Location />\n   ProxyPass "http://0.0.0.0:8080/"\n   ProxyPassReverse "http://0.0.0.0:8080/"\n </Location>\n ErrorLog ${APACHE_LOG_DIR}/rancher-website-error.log\n CustomLog ${APACHE_LOG_DIR}/rancher-website-access.log combined\n</VirtualHost>\n'))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Save and restart apache2"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"  sudo systemctl restart apache2\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install certbot ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://certbot.eff.org/lets-encrypt/ubuntufocal-apache"}),"https://certbot.eff.org/lets-encrypt/ubuntufocal-apache")," and run "),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"sudo snap install core; sudo snap refresh core\n\nsudo snap install --classic certbot\n\nsudo ln -s /snap/bin/certbot /usr/bin/certbot\n\nsudo certbot --apache\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Select the domain that you added in your vhost")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Open your rancher domain and follow from step 2. from the link ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/k8-proxy/s-k8-proxy-rebuild/blob/master/stable-src/README.md#installation-steps-to-deploy-k8s-cluster-on-ec2-instances-using-rancher"}),"https://github.com/k8-proxy/s-k8-proxy-rebuild/blob/master/stable-src/README.md#installation-steps-to-deploy-k8s-cluster-on-ec2-instances-using-rancher"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"A new instance will be created in EC2 instance console."))),Object(c.b)("h2",{id:"creating-an-iam-user-for-docker-repository"},"Creating an IAM user for Docker Repository"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Open the IAM user console ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"http://console.aws.amazon.com/iam"}),"http://console.aws.amazon.com/iam"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on Policies")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on ",Object(c.b)("strong",{parentName:"p"},"Create policy"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Select JSON and paste the following"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),'   {\n "Version": "2012-10-17",\n "Statement": [\n     {\n         "Sid": "VisualEditor0",\n         "Effect": "Allow",\n         "Action": [\n             "ecr:PutImageTagMutability",\n             "ecr:StartImageScan",\n             "ecr:ListTagsForResource",\n             "ecr:UploadLayerPart",\n             "ecr:BatchDeleteImage",\n             "ecr:ListImages",\n             "ecr:CompleteLayerUpload",\n             "ecr:TagResource",\n             "ecr:DescribeRepositories",\n             "ecr:BatchCheckLayerAvailability",\n             "ecr:GetLifecyclePolicy",\n             "ecr:PutLifecyclePolicy",\n             "ecr:DescribeImageScanFindings",\n             "ecr:GetLifecyclePolicyPreview",\n             "ecr:PutImageScanningConfiguration",\n             "ecr:GetDownloadUrlForLayer",\n             "ecr:GetAuthorizationToken",\n             "ecr:DeleteLifecyclePolicy",\n             "ecr:PutImage",\n             "ecr:UntagResource",\n             "ecr:BatchGetImage",\n             "ecr:DescribeImages",\n             "ecr:StartLifecyclePolicyPreview",\n             "ecr:InitiateLayerUpload",\n             "ecr:GetRepositoryPolicy"\n         ],\n         "Resource": "*"\n     }\n   ]\n  }\n')),Object(c.b)("p",{parentName:"li"},Object(c.b)("img",{alt:"step4",src:a(238).default}))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on ",Object(c.b)("strong",{parentName:"p"},"Review Policy"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Name the policy and click on ",Object(c.b)("strong",{parentName:"p"},"Create policy"),"\n",Object(c.b)("img",{alt:"step6",src:a(239).default}))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on Users")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on Add User")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Give name to the group and select ",Object(c.b)("strong",{parentName:"p"},"Programmatic access"),", choose ",Object(c.b)("strong",{parentName:"p"},"Next: Permissions"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on Create Group ")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Type in the name of the group and search for the policy you just created and select it then click on ",Object(c.b)("strong",{parentName:"p"},"Create group"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Select the newly created group, choose ",Object(c.b)("strong",{parentName:"p"},"Next: Tags"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Add tags for the user i.e key rg-gw-dev name ecr-user, choose ",Object(c.b)("strong",{parentName:"p"},"Next: Review"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Review then choose ",Object(c.b)("strong",{parentName:"p"},"Create User"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Download the CSV or save the Access key ID and Secret access key which will be used later for rancher")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Close"))),Object(c.b)("h2",{id:"setting-up-repository-for-docker-in-aws"},"Setting up Repository for Docker in AWS"),Object(c.b)("p",null,"This setup assumes that the nginx, squid and icap applications are in the same repository,seperated by tags instead"),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Open the ECR console ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://console.aws.amazon.com/ecr/home"}),"https://console.aws.amazon.com/ecr/home"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Click on ",Object(c.b)("strong",{parentName:"p"},"Create repository"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Type in a repository name then click on ",Object(c.b)("strong",{parentName:"p"},"Create Repository"),", You'll find a URI for your docker repo on the console copy it")),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"In your client machine, follow these steps to install the aws cli ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html"}),"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Run the command and type in the AWS Access Key ID, AWS Secret Access Key, Default region name, and type in ",Object(c.b)("strong",{parentName:"p"},"json")," in Default output format"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," aws configure\n")),Object(c.b)("p",{parentName:"li"},Object(c.b)("img",{alt:"step5",src:a(240).default}))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install docker if you already have not."),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," sudo apt-get update\n sudo apt-get install apt-transport-https  ca-certificates  curl  gnupg-agent software-properties-common\n curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n sudo apt-key fingerprint 0EBFCD88\n sudo apt-get update\n sudo apt-get install docker-ce docker-ce-cli containerd.io\n")),Object(c.b)("p",{parentName:"li"},"Login to the ECR docker. Replace with URI with the docker-registry-url"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," aws ecr get-login-password --region ap-southeast-1 | docker login --username AWS --password-stdin <docker-registry-url>\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install kubectl if you haven't ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"}),"https://kubernetes.io/docs/tasks/tools/install-kubectl/"),". Create a registry secret to give permission to the kubectl to push in ECR. Replace the AccountID with your AWS Account ID"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),'   #\n   # RUN me where kubectl is available,& make sure to replace account,region etc\n   #\n   ACCOUNT=<ACCOUNT-ID>\n   REGION=ap-southeast-1\n   SECRET_NAME=${REGION}-ecr-registry\n\n   #\n   # Fetch token (which will expire in 12 hours)\n   #\n\n   TOKEN=`aws ecr --region=$REGION get-authorization-token --output text --query authorizationData[].authorizationToken | base64 -d | cut -d: -f2`\n\n   #\n   # Create or replace registry secret\n   #\n   echo TOKEN\n   kubectl delete secret --ignore-not-found $SECRET_NAME\n   kubectl create secret docker-registry $SECRET_NAME \\\n   --docker-server=https://${ACCOUNT}.dkr.ecr.${REGION}.amazonaws.com \\\n   --docker-username=AWS \\\n   --docker-password="${TOKEN}" \\\n'))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Clone the ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/k8-proxy/k8-reverse-proxy"}),"https://github.com/k8-proxy/k8-reverse-proxy")," repository and checkout develop branch"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"git clone https://github.com/k8-proxy/k8-reverse-proxy.git --recursive\ncd stable-src\ngit checkout develop\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Build the applications and push"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," docker build nginx -t <docker-registry-url>:reverse-proxy-nginx-0.0.1\n docker build squid -t <docker-registry-url>:reverse-proxy-squid-0.0.1\n wget -O c-icap/Glasswall-Rebuild-SDK-Evaluation/Linux/Library/libglasswall.classic.so https://github.com/filetrust/Glasswall-Rebuild-SDK-Evaluation/releases/download/1.117/libglasswall.classic.so\n docker build icap -t <docker-registry-url>:reverse-proxy-icap-0.0.1\n docker push <docker-registry-url>/reverse-proxy-nginx-0.0.1\n docker push <docker-registry-url>/reverse-proxy-squid-0.0.1\n docker push <docker-registry-url>/reverse-proxy-icap-0.0.1\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Install helm if you haven't already ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://helm.sh/docs/intro/install/"}),"https://helm.sh/docs/intro/install/"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Clone the ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/k8-proxy/s-k8-proxy-rebuild"}),"https://github.com/k8-proxy/s-k8-proxy-rebuild")," repository"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"git clone https://github.com/k8-proxy/s-k8-proxy-rebuild.git\ncd stable-src\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Run the helm command"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{}),"helm upgrade --install \\\n  --set image.nginx.repository=<docker-registry-url> \\\n  --set image.nginx.tag=reverse-proxy-nginx-0.0.1 \\\n  --set image.squid.repository=<docker-registry-url> \\\n  --set image.squid.tag=reverse-proxy-squid-0.0.1 \\\n  --set image.icap.repository=<docker-registry-url> \\\n  --set image.icap.tag=reverse-proxy-icap-0.0.1 \\\n  reverse-proxy chart/\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Verify that all pods(nginx, squid, icap) are running by executing below command"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(r.a)({parentName:"pre"},{})," kubectl get pods\n"))),Object(c.b)("li",{parentName:"ol"},Object(c.b)("p",{parentName:"li"},"Follow the doc after the ",Object(c.b)("strong",{parentName:"p"},"kubectl get pods")," part ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/k8-proxy/s-k8-proxy-rebuild/tree/master/stable-src#deploy-to-kubernetes"}),"https://github.com/k8-proxy/s-k8-proxy-rebuild/tree/master/stable-src#deploy-to-kubernetes"),". You'll find the ip for your k8s node on the EC2 instance console."))))}p.isMDXComponent=!0}}]);